<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œæ•´èœå•åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .title {
            font-size: 32px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            font-size: 18px;
        }
        .test-section {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
        }
        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #495057;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .step-number {
            background: #007bff;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 8px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .btn:hover {
            background: #0056b3;
            transform: translateY(-1px);
        }
        .btn.success {
            background: #28a745;
        }
        .btn.success:hover {
            background: #218838;
        }
        .btn.danger {
            background: #dc3545;
        }
        .btn.danger:hover {
            background: #c82333;
        }
        .btn.warning {
            background: #ffc107;
            color: #212529;
        }
        .btn.warning:hover {
            background: #e0a800;
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-weight: 500;
            font-size: 16px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .info-box {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            font-size: 14px;
        }
        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .link-btn {
            background: #6c757d;
            color: white;
            text-decoration: none;
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            transition: all 0.3s ease;
            display: block;
        }
        .link-btn:hover {
            background: #5a6268;
            transform: translateY(-1px);
        }
        .link-btn.primary {
            background: #007bff;
        }
        .link-btn.primary:hover {
            background: #0056b3;
        }
        .result-display {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 200px;
            overflow-y: auto;
        }
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .feature-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            text-align: center;
        }
        .feature-icon {
            font-size: 24px;
            margin-bottom: 10px;
        }
        .feature-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        .feature-desc {
            font-size: 13px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ğŸ¯ å®Œæ•´èœå•åŠŸèƒ½æµ‹è¯•</h1>
            <p class="subtitle">ä¸€ç«™å¼æµ‹è¯•å·¦ä¾§èœå•æ æ˜¾ç¤ºå’Œèœå•ç®¡ç†åŠŸèƒ½</p>
        </div>

        <!-- æ­¥éª¤1ï¼šè®¾ç½®ç™»å½•çŠ¶æ€ -->
        <div class="test-section">
            <div class="section-title">
                <div class="step-number">1</div>
                è®¾ç½®ç™»å½•çŠ¶æ€
            </div>
            <div class="info-box">
                <strong>è¯´æ˜ï¼š</strong>é¦–å…ˆéœ€è¦è®¾ç½®æ­£ç¡®çš„ç™»å½•çŠ¶æ€ï¼Œè¿™æ˜¯æ˜¾ç¤ºå·¦ä¾§èœå•æ çš„å‰ææ¡ä»¶ã€‚
            </div>
            <div id="login-status" class="status info">ç‚¹å‡»æŒ‰é’®è®¾ç½®ç™»å½•çŠ¶æ€...</div>
            <button class="btn success" onclick="forceLogin()">ğŸ”‘ å¼ºåˆ¶è®¾ç½®ç™»å½•çŠ¶æ€</button>
            <button class="btn danger" onclick="clearLogin()">ğŸ—‘ï¸ æ¸…é™¤ç™»å½•çŠ¶æ€</button>
            <button class="btn" onclick="checkLoginStatus()">ğŸ” æ£€æŸ¥å½“å‰çŠ¶æ€</button>
            <div id="login-info" class="result-display" style="display: none;"></div>
        </div>

        <!-- æ­¥éª¤2ï¼šéªŒè¯èœå•æ˜¾ç¤º -->
        <div class="test-section">
            <div class="section-title">
                <div class="step-number">2</div>
                éªŒè¯èœå•æ˜¾ç¤º
            </div>
            <div class="info-box">
                <strong>è¯´æ˜ï¼š</strong>è®¾ç½®ç™»å½•çŠ¶æ€åï¼Œè®¿é—®ç®¡ç†åå°æ£€æŸ¥å·¦ä¾§èœå•æ æ˜¯å¦æ­£å¸¸æ˜¾ç¤ºã€‚
            </div>
            <div id="menu-status" class="status info">è®¾ç½®ç™»å½•çŠ¶æ€åï¼Œç‚¹å‡»ä¸‹é¢çš„é“¾æ¥æµ‹è¯•èœå•æ˜¾ç¤º</div>
            <div class="quick-links">
                <a href="/admin" class="link-btn primary" target="_blank">ğŸ  ç®¡ç†åå°é¦–é¡µ</a>
                <a href="/admin/users" class="link-btn" target="_blank">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</a>
                <a href="/admin/roles" class="link-btn" target="_blank">ğŸ” è§’è‰²ç®¡ç†</a>
                <a href="/admin/menus" class="link-btn" target="_blank">ğŸ“‹ èœå•ç®¡ç†</a>
                <a href="/admin/enterprise-verify" class="link-btn" target="_blank">ğŸ“‹ ä¼ä¸šè®¤è¯</a>
                <a href="/admin/enterprise-manage" class="link-btn" target="_blank">ğŸª ä¼ä¸šç®¡ç†</a>
            </div>
        </div>

        <!-- æ­¥éª¤3ï¼šæµ‹è¯•èœå•ç®¡ç†åŠŸèƒ½ -->
        <div class="test-section">
            <div class="section-title">
                <div class="step-number">3</div>
                æµ‹è¯•èœå•ç®¡ç†åŠŸèƒ½
            </div>
            <div class="info-box">
                <strong>è¯´æ˜ï¼š</strong>é€šè¿‡èœå•ç®¡ç†é¡µé¢ï¼Œå¯ä»¥å¯¹å·¦ä¾§åŠŸèƒ½æ è¿›è¡Œå¢åˆ æ”¹æ“ä½œã€‚
            </div>
            <div id="management-status" class="status info">è®¿é—®èœå•ç®¡ç†é¡µé¢æµ‹è¯•åŠŸèƒ½</div>
            
            <div class="feature-list">
                <div class="feature-item">
                    <div class="feature-icon">ğŸ”„</div>
                    <div class="feature-title">çŠ¶æ€åˆ‡æ¢</div>
                    <div class="feature-desc">å¯ç”¨/ç¦ç”¨èœå•é¡¹ï¼Œå®æ—¶åæ˜ åˆ°å·¦ä¾§å¯¼èˆªæ </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">â•</div>
                    <div class="feature-title">æ–°å¢èœå•</div>
                    <div class="feature-desc">æ·»åŠ æ–°çš„èœå•é¡¹å’Œå­èœå•</div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">âœï¸</div>
                    <div class="feature-title">ç¼–è¾‘èœå•</div>
                    <div class="feature-desc">ä¿®æ”¹èœå•åç§°ã€å›¾æ ‡ã€è·¯å¾„ç­‰ä¿¡æ¯</div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">ğŸ—‘ï¸</div>
                    <div class="feature-title">åˆ é™¤èœå•</div>
                    <div class="feature-desc">åˆ é™¤ä¸éœ€è¦çš„èœå•é¡¹</div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">ğŸ”€</div>
                    <div class="feature-title">æ’åºè°ƒæ•´</div>
                    <div class="feature-desc">è°ƒæ•´èœå•æ˜¾ç¤ºé¡ºåº</div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">ğŸ“¦</div>
                    <div class="feature-title">æ‰¹é‡æ“ä½œ</div>
                    <div class="feature-desc">æ‰¹é‡å¯ç”¨ã€ç¦ç”¨æˆ–åˆ é™¤èœå•</div>
                </div>
            </div>
            
            <button class="btn primary" onclick="openMenuManagement()">ğŸš€ æ‰“å¼€èœå•ç®¡ç†é¡µé¢</button>
        </div>

        <!-- æ­¥éª¤4ï¼šéªŒè¯å®æ—¶æ•ˆæœ -->
        <div class="test-section">
            <div class="section-title">
                <div class="step-number">4</div>
                éªŒè¯å®æ—¶æ•ˆæœ
            </div>
            <div class="info-box">
                <strong>è¯´æ˜ï¼š</strong>åœ¨èœå•ç®¡ç†é¡µé¢è¿›è¡Œæ“ä½œåï¼Œæ£€æŸ¥å·¦ä¾§èœå•æ çš„å˜åŒ–ã€‚
            </div>
            <div id="realtime-status" class="status info">è¿›è¡Œèœå•æ“ä½œåï¼Œæ£€æŸ¥å®æ—¶æ•ˆæœ</div>
            
            <div class="status warning">
                <strong>æµ‹è¯•æ­¥éª¤ï¼š</strong><br>
                1. åœ¨èœå•ç®¡ç†é¡µé¢ç¦ç”¨æŸä¸ªèœå•é¡¹<br>
                2. è¿”å›ç®¡ç†åå°é¦–é¡µï¼Œæ£€æŸ¥è¯¥èœå•é¡¹æ˜¯å¦æ¶ˆå¤±<br>
                3. é‡æ–°å¯ç”¨è¯¥èœå•é¡¹<br>
                4. åˆ·æ–°é¡µé¢ï¼Œæ£€æŸ¥èœå•é¡¹æ˜¯å¦é‡æ–°å‡ºç°
            </div>
        </div>

        <!-- æ­¥éª¤5ï¼šé—®é¢˜æ’æŸ¥ -->
        <div class="test-section">
            <div class="section-title">
                <div class="step-number">5</div>
                é—®é¢˜æ’æŸ¥
            </div>
            <div class="info-box">
                <strong>è¯´æ˜ï¼š</strong>å¦‚æœé‡åˆ°é—®é¢˜ï¼Œä½¿ç”¨ä»¥ä¸‹å·¥å…·è¿›è¡Œæ’æŸ¥ã€‚
            </div>
            <div id="debug-status" class="status info">ä½¿ç”¨è°ƒè¯•å·¥å…·æ’æŸ¥é—®é¢˜</div>
            
            <button class="btn warning" onclick="openConsoleDebug()">ğŸ”§ æ‰“å¼€æ§åˆ¶å°è°ƒè¯•</button>
            <button class="btn" onclick="checkBrowserStorage()">ğŸ’¾ æ£€æŸ¥æµè§ˆå™¨å­˜å‚¨</button>
            <button class="btn" onclick="testNetworkRequests()">ğŸŒ æ£€æŸ¥ç½‘ç»œè¯·æ±‚</button>
            
            <div id="debug-info" class="result-display" style="display: none;"></div>
        </div>
    </div>

    <script>
        function updateStatus(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            if (element) {
                element.className = `status ${type}`;
                element.innerHTML = message;
            }
        }

        function forceLogin() {
            const mockToken = 'Bearer_mock_admin_token_' + Date.now();
            const mockUser = {
                user_id: 1,
                username: 'admin',
                user_type: 'admin',
                email: 'admin@example.com',
                roles: ['admin'],
                permissions: ['dashboard:view', 'users:manage', 'roles:manage', 'menus:manage', 'enterprise:manage']
            };

            // ä½¿ç”¨æ­£ç¡®çš„localStorage key
            localStorage.setItem('txgy_token', mockToken);
            localStorage.setItem('user_info', JSON.stringify(mockUser));

            updateStatus('login-status', 'âœ… <strong>ç™»å½•çŠ¶æ€è®¾ç½®æˆåŠŸï¼</strong><br>ç°åœ¨å¯ä»¥è®¿é—®ç®¡ç†åå°äº†', 'success');
            updateStatus('menu-status', 'âœ… <strong>å¯ä»¥æµ‹è¯•èœå•æ˜¾ç¤ºäº†ï¼</strong><br>ç‚¹å‡»ä¸Šé¢çš„é“¾æ¥è®¿é—®å„ä¸ªé¡µé¢', 'success');
            
            const loginInfo = document.getElementById('login-info');
            loginInfo.style.display = 'block';
            loginInfo.textContent = `Token: ${mockToken}\nUser: ${JSON.stringify(mockUser, null, 2)}`;
            
            console.log('ğŸ”§ å¼ºåˆ¶ç™»å½•è®¾ç½®å®Œæˆ');
        }

        function clearLogin() {
            localStorage.removeItem('txgy_token');
            localStorage.removeItem('auth_token');
            localStorage.removeItem('user_info');
            
            updateStatus('login-status', 'âŒ <strong>ç™»å½•çŠ¶æ€å·²æ¸…é™¤</strong><br>éœ€è¦é‡æ–°è®¾ç½®ç™»å½•çŠ¶æ€', 'error');
            updateStatus('menu-status', 'âš ï¸ <strong>éœ€è¦å…ˆè®¾ç½®ç™»å½•çŠ¶æ€</strong>', 'warning');
            
            document.getElementById('login-info').style.display = 'none';
            console.log('ğŸ”§ ç™»å½•çŠ¶æ€å·²æ¸…é™¤');
        }

        function checkLoginStatus() {
            const token = localStorage.getItem('txgy_token') || localStorage.getItem('auth_token');
            const userInfo = localStorage.getItem('user_info');
            
            if (token && userInfo) {
                updateStatus('login-status', 'âœ… <strong>å·²ç™»å½•</strong><br>æ£€æµ‹åˆ°æœ‰æ•ˆçš„ç™»å½•çŠ¶æ€', 'success');
                const loginInfo = document.getElementById('login-info');
                loginInfo.style.display = 'block';
                loginInfo.textContent = `Token: ${token}\nUser Info: ${userInfo}`;
            } else {
                updateStatus('login-status', 'âŒ <strong>æœªç™»å½•</strong><br>æœªæ£€æµ‹åˆ°æœ‰æ•ˆçš„ç™»å½•çŠ¶æ€', 'error');
                document.getElementById('login-info').style.display = 'none';
            }
        }

        function openMenuManagement() {
            window.open('/admin/menus', '_blank');
            updateStatus('management-status', 'âœ… <strong>èœå•ç®¡ç†é¡µé¢å·²æ‰“å¼€</strong><br>è¯·åœ¨æ–°çª—å£ä¸­æµ‹è¯•èœå•ç®¡ç†åŠŸèƒ½', 'success');
        }

        function openConsoleDebug() {
            alert('è¯·æŒ‰F12æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼Œåœ¨Consoleæ ‡ç­¾é¡µä¸­æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯');
            updateStatus('debug-status', 'ğŸ”§ <strong>è¯·æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°</strong><br>æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯¦ç»†æ—¥å¿—', 'info');
        }

        function checkBrowserStorage() {
            const debugInfo = document.getElementById('debug-info');
            debugInfo.style.display = 'block';
            
            const storageInfo = {
                'txgy_token': localStorage.getItem('txgy_token'),
                'auth_token': localStorage.getItem('auth_token'),
                'user_info': localStorage.getItem('user_info')
            };
            
            debugInfo.textContent = 'LocalStorageå†…å®¹:\n' + JSON.stringify(storageInfo, null, 2);
            updateStatus('debug-status', 'ğŸ’¾ <strong>æµè§ˆå™¨å­˜å‚¨ä¿¡æ¯å·²æ˜¾ç¤º</strong>', 'info');
        }

        function testNetworkRequests() {
            updateStatus('debug-status', 'ğŸŒ <strong>è¯·åœ¨Networkæ ‡ç­¾é¡µä¸­æ£€æŸ¥ç½‘ç»œè¯·æ±‚</strong><br>ç‰¹åˆ«å…³æ³¨APIè¯·æ±‚çš„çŠ¶æ€ç å’Œå“åº”', 'info');
            alert('è¯·åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„Networkæ ‡ç­¾é¡µä¸­æ£€æŸ¥ç½‘ç»œè¯·æ±‚');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥ç™»å½•çŠ¶æ€
        window.onload = function() {
            checkLoginStatus();
        };
    </script>
</body>
</html>
